# Japanese SentiStrength
Japanese version of the SentiStrength sentiment analysis program.

## Overview 
SentiStrength (http://sentistrength.wlv.ac.uk/) is a sentiment analysis package that assigns a positive intensity label and a negative intensity label to English texts, optimized for short, social media web texts (Thelwall et al., 2010). The package has two parts: a program with built-in language structural and grammatical rules, and a dictionary set with machine-learning-trained positive/negative intensity labels. This repository contains the Japanese version of this program. This includes the program (JP_SentiStrength.jar), the dictionary set (SentiStrength_DataJapanese), along with a Python script that preprocesses the raw data and engages with the program and dictionary set. 

## Repo Contents
- **JP_SentiStrength.jar**: the program
- **SentiStrength_DataJapanese**: the dictionary set
- **run_jp_sentistrength.py**: Python script that preprocesses the raw data and engages with the program and dictionary set. It takes in as input the file paths of the algorithm and dictionary set, and the file path of the input data, and saves the program output to a separate data file. 
- **example_data.csv**: small dataset to demo the program. This contains ten public Japanese tweets (some modified to remove user handles).
- **example_output.txt**: output generated by the program applied on example_data.csv.

## Installation Guide
Users should download this repository to their local machines, which should take about 20 seconds. The repository can be saved anywhere.

## System Requirements
The program is a Java program, so Java must be installed (https://www.java.com/en/download/). 

The Python script is written in Python 2.7, which should be used instead of Pyton 3. Users must further install these Python packages. All are installable through pip except JNlp.
- numpy
- pandas
- csv
- emoji
- re
- io
- subprocess
- shlex
- os
- sys
- tinysegmenter (segments Japanese text into semantically relevant terms)
- jNlp (installation guide here: https://jprocessing.readthedocs.io/en/latest/#install)

The program has been tested on java 9.0.1, and on MacOS High Sierra, Mojave, and Catalina. 

## Instructions for Use
Please make sure that Java and all necessary packages as outlined in System Requirements are installed.

To run the program, open command line tool (e.g. Terminal on Macs), then type in this command with the variables replaced per following instructions:
```
python run_jp_sentistrength.py input_file_path output_folder_path sentistrength_path sentistrength_dictionary_path
```

- **input_file_path**: file path to the file with raw text (REQUIRES ending with '.csv'). IMPORTANT:_The column that contains the raw text must be named "message"_
- **output_folder_path**: file path to folder where you want to save your processed text file (REQUIRES ending with '/')
- **sentistrength_path**: file path to the Japanese SentiStrength program (where JP_SentiStrength.jar is saved on user's local machine)
- **sentistrength_dictionary_path**: file path to the folder of the Japanese SentiStrength dictionary files (where SentiStrength_DataJapanese is saved on user's local machine; REQUIRES ending with '/')

Example command:
```
python run_jp_sentistrength.py example_data.csv ./ JP_SentiStrength.jar SentiStrength_DataJapanese/
```

Processing could take some time to finish (~30 seconds for thousands of rows; ~5 min for tens of millions of rows). The results will be saved under output_messages0_out.txt in the output_folder_path; please ensure that the output file has the same number of rows as the input file. The output file contents will be in this format:

Positive  Negative  Text<br>
1 -1  [processed text 1]<br>
1 -3  [processed text 2]<br>
...

Please see example_output.txt in this repository for an example output file. 

To run this program on data used in the paper, simply type in the data files as input_file_path. Since there are multiple data files, be sure to change the name of the output file (output_messages0_out.txt) after running the program on each data file so that output files are not overwritten.


### Additional Capabilities
Structural rules for Japanese were built into the program. All four of these structural rules can be turned on/off and modified using the parameters in the java command line (run_jp_sentistrength.py, line 98).
1) The ability to turn off applying negation before the term to be negated (which is the case for English, but not Japanese).
- Include "negatingWordsOccurAfterSentiment" to turn on the ability, exclude to turn off. 
2) The ability to apply negation _after_ the term to be negated (e.g. "happy not" instead of "not happy")
- Include "maxWordsAfterSentimentToNegate 1" to set the maximum number of words that the negation can occur after the term to be negated. The number 1 can be modified to any integer (including 0). This ability can only be added if 1) is turned on.
3) The ability to assign the maximum number of words that the negation term (e.g. "not") can occur after the term to be negated (e.g. "happy") for the negation to apply/
- Include "negatingWordsDontOccurBeforeSentiment" to turn on the ability, exclude to turn off.
4) Booster terms (e.g. "extremely," "a little"), like negation terms, also apply after the term to be boosted. The ability to assign the maximum number of words after the term to be boosted for the booster term to apply.
- Include "maxWordsAfterBoosters 1" to set the maximum number of words after the term to be boosted for the booster term to apply. The number 1 can be modified to any integer (including 0).

This is the default as in the script: <br>
"negatingWordsOccurAfterSentiment maxWordsAfterSentimentToNegate 1 negatingWordsDontOccurBeforeSentiment maxWordsAfterBoosters 1". <br>
The decisions for these default settings are supported in the paper. 


Japanese SentiStrength includes capabilities as those in English SentiStrength See the SentiStrength Java Manual provided by the English SentiStrength developers (http://sentistrength.wlv.ac.uk/documentation/SentiStrengthJavaManual.doc). 


## Authors
- **Tiffany W. Hsu** (PhD candidate, Stanford University)
- **Mike Thelwall** (Professor, University of Wolverhampton)
- **Yu Niiya** (Professor, Hosei University) 
- **Katherine Sun** (Undergraduate student, Yale University)


